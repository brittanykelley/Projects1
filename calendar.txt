create or replace view CALENDAR(
	DAY_DATE_YYYYWW,
	DAY_DATE,
	TIMEFRAME
) as
 SELECT 
    CONCAT(YEAR(DAY_DATE), '0', WEEK(DAY_DATE)) AS DAY_DATE_YYYYWW, TO_CHAR(DAY_DATE, 'YYYY-MM-DD') AS DAY_DATE,
    CASE
        WHEN DAY_DATE >= DATE_TRUNC('week', CURRENT_DATE) AND DAY_DATE <= CURRENT_DATE THEN 'Current week'
    WHEN DAY_DATE >= DATEADD(DAY, -7, CURRENT_DATE) AND DAY_DATE <= CURRENT_DATE THEN 'Last week'
    WHEN DAY_DATE >= DATEADD(DAY, -4*7, CURRENT_DATE) AND DAY_DATE <= CURRENT_DATE THEN 'Last 4 weeks'
    WHEN DAY_DATE >= DATEADD(DAY, -13*7, CURRENT_DATE) AND DAY_DATE <= CURRENT_DATE THEN 'Last 13 weeks'
    WHEN DAY_DATE >= DATEADD(DAY, -26*7, CURRENT_DATE) AND DAY_DATE <= CURRENT_DATE THEN 'Last 26 weeks'
    WHEN DAY_DATE >= DATEADD(DAY, -52*7, CURRENT_DATE) AND DAY_DATE <= CURRENT_DATE THEN 'Last 52 weeks'
        ELSE NULL
    END AS timeframe
FROM 
    TABLE
WHERE 
    DAY_DATE >= DATEADD(DAY, -365, CURRENT_DATE)
    AND DAY_DATE <= CURRENT_DAT